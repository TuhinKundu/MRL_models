2024-03-25,16:53:51 | INFO | Running with a single process. Device cuda:0.
2024-03-25,16:53:51 | INFO | Loaded ViT-B-16 model config.
2024-03-25,16:53:53 | INFO | Model:
2024-03-25,16:53:53 | INFO | CLIP(
  (visual): VisionTransformer(
    (patchnorm_pre_ln): Identity()
    (conv1): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16), bias=False)
    (patch_dropout): Identity()
    (ln_pre): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (transformer): Transformer(
      (resblocks): ModuleList(
        (0-11): 12 x ResidualAttentionBlock(
          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
          )
          (ls_1): Identity()
          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=768, out_features=3072, bias=True)
            (gelu): GELU(approximate='none')
            (c_proj): Linear(in_features=3072, out_features=768, bias=True)
          )
          (ls_2): Identity()
        )
      )
    )
    (ln_post): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
  )
  (transformer): Transformer(
    (resblocks): ModuleList(
      (0-11): 12 x ResidualAttentionBlock(
        (ln_1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=512, out_features=512, bias=True)
        )
        (ls_1): Identity()
        (ln_2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (mlp): Sequential(
          (c_fc): Linear(in_features=512, out_features=2048, bias=True)
          (gelu): GELU(approximate='none')
          (c_proj): Linear(in_features=2048, out_features=512, bias=True)
        )
        (ls_2): Identity()
      )
    )
  )
  (token_embedding): Embedding(49408, 512)
  (ln_final): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (logit_scale): ParameterList(
      (0): Parameter containing: [torch.float32 of size  (cuda:0)]
      (1): Parameter containing: [torch.float32 of size  (cuda:0)]
      (2): Parameter containing: [torch.float32 of size  (cuda:0)]
      (3): Parameter containing: [torch.float32 of size  (cuda:0)]
      (4): Parameter containing: [torch.float32 of size  (cuda:0)]
  )
)
2024-03-25,16:53:53 | INFO | Params:
2024-03-25,16:53:53 | INFO |   accum_freq: 1
2024-03-25,16:53:53 | INFO |   aug_cfg: {}
2024-03-25,16:53:53 | INFO |   batch_size: 128
2024-03-25,16:53:53 | INFO |   beta1: 0.9
2024-03-25,16:53:53 | INFO |   beta2: 0.98
2024-03-25,16:53:53 | INFO |   checkpoint_path: /mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/scripts/logs/mrl_clip_b256_accum_1_ep40_diffLogitScale_D032524_w1_gpu1_wkrs1/checkpoints
2024-03-25,16:53:53 | INFO |   coca_caption_loss_weight: 2.0
2024-03-25,16:53:53 | INFO |   coca_contrastive_loss_weight: 1.0
2024-03-25,16:53:53 | INFO |   copy_codebase: False
2024-03-25,16:53:53 | INFO |   csv_caption_key: title
2024-03-25,16:53:53 | INFO |   csv_img_key: filepath
2024-03-25,16:53:53 | INFO |   csv_separator: 	
2024-03-25,16:53:53 | INFO |   dataset_resampled: False
2024-03-25,16:53:53 | INFO |   dataset_type: webdataset
2024-03-25,16:53:53 | INFO |   ddp_static_graph: False
2024-03-25,16:53:53 | INFO |   debug: False
2024-03-25,16:53:53 | INFO |   delete_previous_checkpoint: False
2024-03-25,16:53:53 | INFO |   device: cuda:0
2024-03-25,16:53:53 | INFO |   dist_backend: nccl
2024-03-25,16:53:53 | INFO |   dist_url: env://
2024-03-25,16:53:53 | INFO |   distill: False
2024-03-25,16:53:53 | INFO |   distill_model: None
2024-03-25,16:53:53 | INFO |   distill_pretrained: None
2024-03-25,16:53:53 | INFO |   distributed: False
2024-03-25,16:53:53 | INFO |   epochs: 40
2024-03-25,16:53:53 | INFO |   epochs_cooldown: None
2024-03-25,16:53:53 | INFO |   eps: 1e-06
2024-03-25,16:53:53 | INFO |   force_custom_text: False
2024-03-25,16:53:53 | INFO |   force_image_size: None
2024-03-25,16:53:53 | INFO |   force_mrl_loss: True
2024-03-25,16:53:53 | INFO |   force_patch_dropout: None
2024-03-25,16:53:53 | INFO |   force_quick_gelu: False
2024-03-25,16:53:53 | INFO |   gather_with_grad: True
2024-03-25,16:53:53 | INFO |   grad_checkpointing: False
2024-03-25,16:53:53 | INFO |   grad_clip_norm: None
2024-03-25,16:53:53 | INFO |   horovod: False
2024-03-25,16:53:53 | INFO |   image_mean: None
2024-03-25,16:53:53 | INFO |   image_std: None
2024-03-25,16:53:53 | INFO |   imagenet_v2: None
2024-03-25,16:53:53 | INFO |   imagenet_val: /gscratch/krishna/arnabk1/root/val/
2024-03-25,16:53:53 | INFO |   local_loss: True
2024-03-25,16:53:53 | INFO |   local_rank: 0
2024-03-25,16:53:53 | INFO |   lock_image: False
2024-03-25,16:53:53 | INFO |   lock_image_freeze_bn_stats: False
2024-03-25,16:53:53 | INFO |   lock_image_unlocked_groups: 0
2024-03-25,16:53:53 | INFO |   lock_text: False
2024-03-25,16:53:53 | INFO |   lock_text_freeze_layer_norm: False
2024-03-25,16:53:53 | INFO |   lock_text_unlocked_layers: 0
2024-03-25,16:53:53 | INFO |   log_every_n_steps: 100
2024-03-25,16:53:53 | INFO |   log_level: 20
2024-03-25,16:53:53 | INFO |   log_local: False
2024-03-25,16:53:53 | INFO |   log_path: /mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/scripts/logs/mrl_clip_b256_accum_1_ep40_diffLogitScale_D032524_w1_gpu1_wkrs1/out.log
2024-03-25,16:53:53 | INFO |   logs: /mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/scripts/logs/
2024-03-25,16:53:53 | INFO |   lr: 0.0005
2024-03-25,16:53:53 | INFO |   lr_cooldown_end: 0.0
2024-03-25,16:53:53 | INFO |   lr_cooldown_power: 1.0
2024-03-25,16:53:53 | INFO |   lr_scheduler: cosine
2024-03-25,16:53:53 | INFO |   model: ViT-B-16
2024-03-25,16:53:53 | INFO |   mrl_dim_to_consider: [768, 384, 192, 96, 48]
2024-03-25,16:53:53 | INFO |   mrl_loss_weights: [1.0, 1.0, 1.0, 1.0, 1.0]
2024-03-25,16:53:53 | INFO |   name: mrl_clip_b256_accum_1_ep40_diffLogitScale_D032524_w1_gpu1_wkrs1
2024-03-25,16:53:53 | INFO |   no_set_device_rank: False
2024-03-25,16:53:53 | INFO |   precision: amp
2024-03-25,16:53:53 | INFO |   pretrained: 
2024-03-25,16:53:53 | INFO |   pretrained_image: False
2024-03-25,16:53:53 | INFO |   rank: 0
2024-03-25,16:53:53 | INFO |   remote_sync: None
2024-03-25,16:53:53 | INFO |   remote_sync_frequency: 300
2024-03-25,16:53:53 | INFO |   remote_sync_protocol: s3
2024-03-25,16:53:53 | INFO |   report_to: wandb
2024-03-25,16:53:53 | INFO |   resume: None
2024-03-25,16:53:53 | INFO |   save_frequency: 1
2024-03-25,16:53:53 | INFO |   save_most_recent: False
2024-03-25,16:53:53 | INFO |   seed: 42
2024-03-25,16:53:53 | INFO |   skip_scheduler: False
2024-03-25,16:53:53 | INFO |   tensorboard: False
2024-03-25,16:53:53 | INFO |   tensorboard_path: 
2024-03-25,16:53:53 | INFO |   torchscript: False
2024-03-25,16:53:53 | INFO |   trace: False
2024-03-25,16:53:53 | INFO |   train_data: /gscratch/krishna/chenhaoz/IL/FDT/data/cc3m/{00000..00331}.tar
2024-03-25,16:53:53 | INFO |   train_data_upsampling_factors: None
2024-03-25,16:53:53 | INFO |   train_num_samples: 3308333
2024-03-25,16:53:53 | INFO |   use_bn_sync: False
2024-03-25,16:53:53 | INFO |   val_data: None
2024-03-25,16:53:53 | INFO |   val_frequency: 1
2024-03-25,16:53:53 | INFO |   val_num_samples: None
2024-03-25,16:53:53 | INFO |   wandb: True
2024-03-25,16:53:53 | INFO |   wandb_notes: 
2024-03-25,16:53:53 | INFO |   wandb_project_name: mrl_clip_training
2024-03-25,16:53:53 | INFO |   warmup: 4000
2024-03-25,16:53:53 | INFO |   wd: 0.2
2024-03-25,16:53:53 | INFO |   workers: 22
2024-03-25,16:53:53 | INFO |   world_size: 1
2024-03-25,16:53:53 | INFO |   zeroshot_frequency: 2
2024-03-25,16:54:21 | INFO | Start epoch 0
2024-03-25,16:54:59 | INFO | Train Epoch: 0 [    128/3308800 (0%)] Data (t): 22.479 Batch (t): 37.559, 3.40797/s, 3.40797/s/gpu LR: 0.000000 Logit Scale: 14.286 ,14.286 ,14.286 ,14.286 ,14.286 Mrl_clip_loss_768: 4.9933 (4.9933) Mrl_clip_loss_384: 5.0133 (5.0133) Mrl_clip_loss_192: 5.0613 (5.0613) Mrl_clip_loss_96: 5.1029 (5.1029) Mrl_clip_loss_48: 5.3367 (5.3367) Loss: 25.508 (25.508)
2024-03-25,16:55:45 | INFO | Train Epoch: 0 [  12928/3308800 (0%)] Data (t): 0.063 Batch (t): 0.459, 268.142/s, 268.142/s/gpu LR: 0.000013 Logit Scale: 14.287 ,14.286 ,14.284 ,14.284 ,14.284 Mrl_clip_loss_768: 4.7204 (4.8568) Mrl_clip_loss_384: 4.7189 (4.8661) Mrl_clip_loss_192: 4.7089 (4.8851) Mrl_clip_loss_96: 4.7056 (4.9042) Mrl_clip_loss_48: 4.7091 (5.0229) Loss: 23.563 (24.535)
2024-03-25,16:56:30 | INFO | Train Epoch: 0 [  25728/3308800 (1%)] Data (t): 0.059 Batch (t): 0.453, 268.966/s, 268.966/s/gpu LR: 0.000025 Logit Scale: 14.298 ,14.287 ,14.279 ,14.276 ,14.279 Mrl_clip_loss_768: 4.5208 (4.7448) Mrl_clip_loss_384: 4.5236 (4.7520) Mrl_clip_loss_192: 4.5374 (4.7692) Mrl_clip_loss_96: 4.5441 (4.7842) Mrl_clip_loss_48: 4.5491 (4.8650) Loss: 22.675 (23.915)
2024-03-25,16:57:15 | INFO | Train Epoch: 0 [  38528/3308800 (1%)] Data (t): 0.059 Batch (t): 0.452, 279.187/s, 279.187/s/gpu LR: 0.000038 Logit Scale: 14.306 ,14.283 ,14.271 ,14.267 ,14.273 Mrl_clip_loss_768: 4.4214 (4.6640) Mrl_clip_loss_384: 4.4188 (4.6687) Mrl_clip_loss_192: 4.4284 (4.6840) Mrl_clip_loss_96: 4.4328 (4.6964) Mrl_clip_loss_48: 4.4289 (4.7559) Loss: 22.130 (23.469)
