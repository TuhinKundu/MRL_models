[2024-03-27 18:48:45,657] torch.distributed.run: [WARNING] 
[2024-03-27 18:48:45,657] torch.distributed.run: [WARNING] *****************************************
[2024-03-27 18:48:45,657] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-03-27 18:48:45,657] torch.distributed.run: [WARNING] *****************************************
2024-03-27,18:50:01 | INFO | Running in distributed mode with multiple processes. Device: cuda:2.Process (global: 2, local 2), total 4.
2024-03-27,18:50:01 | INFO | Loaded ViT-B-16 model config.
2024-03-27,18:50:01 | INFO | Running in distributed mode with multiple processes. Device: cuda:3.Process (global: 3, local 3), total 4.
2024-03-27,18:50:01 | INFO | Loaded ViT-B-16 model config.
2024-03-27,18:50:01 | INFO | Running in distributed mode with multiple processes. Device: cuda:1.Process (global: 1, local 1), total 4.
2024-03-27,18:50:01 | INFO | Loaded ViT-B-16 model config.
2024-03-27,18:50:08 | INFO | Loading pretrained ViT-B-16 weights (laion400m_e32).
2024-03-27,18:50:08 | INFO | Loading pretrained ViT-B-16 weights (laion400m_e32).
2024-03-27,18:50:09 | INFO | Loading pretrained ViT-B-16 weights (laion400m_e32).
[rank3]:[W socket.cpp:432] [c10d] While waitForInput, poolFD failed with (errno: 0 - Success).
[rank1]:[W socket.cpp:432] [c10d] While waitForInput, poolFD failed with (errno: 0 - Success).
[rank2]:[W socket.cpp:432] [c10d] While waitForInput, poolFD failed with (errno: 0 - Success).
Traceback (most recent call last):
Traceback (most recent call last):
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 196, in _run_module_as_main
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 196, in _run_module_as_main
Traceback (most recent call last):
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 86, in _run_code
    return _run_code(code, main_globals, None,
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 472, in <module>
    exec(code, run_globals)
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 472, in <module>
    return _run_code(code, main_globals, None,
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 472, in <module>
        main(sys.argv[1:])main(sys.argv[1:])

  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 282, in main
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 282, in main
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[device], **ddp_args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[device], **ddp_args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    main(sys.argv[1:])
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 282, in main
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[device], **ddp_args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: [2] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
Exception raised from doWait at ../torch/csrc/distributed/c10d/TCPStore.cpp:550 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14691313ed87 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x15c0e57 (0x14694ab60e57 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14694ee2fce2 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14694ee30b11 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14694ede5f81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14694ede5f81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14694ede5f81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14694ede5f81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x1469142ba4e9 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x1469142c14db in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::allgather(std::vector<std::vector<at::Tensor, std::allocator<at::Tensor> >, std::allocator<std::vector<at::Tensor, std::allocator<at::Tensor> > > >&, std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllgatherOptions const&) + 0xb5c (0x1469142d78dc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x583a31d (0x14694edda31d in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5844218 (0x14694ede4218 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x4e893cc (0x14694e4293cc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x1a08a88 (0x14694afa8a88 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x584ba33 (0x14694edeba33 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5856e1f (0x14694edf6e1f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: c10d::verify_params_across_processes(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::optional<std::weak_ptr<c10d::Logger> > const&) + 0x26f (0x14694ee5d48f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xc57771 (0x146961660771 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x413f14 (0x146960e1cf14 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fc697]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f614b in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x53d6 (0x4f2376 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #26: _PyObject_FastCallDictTstate + 0x17d (0x4f56cd in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #27: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x505be8]
frame #28: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4f64b6]
frame #29: PyObject_Call + 0x209 (0x5089a9 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x2b79 (0x4efb19 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #33: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x591d92]
frame #34: PyEval_EvalCode + 0x87 (0x591cd7 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #35: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5991cd]
frame #36: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fccc4]
frame #37: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #41: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5b4dcf]
frame #42: Py_RunMain + 0xc2 (0x5b48b2 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #43: Py_BytesMain + 0x39 (0x584e49 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #44: __libc_start_main + 0xe5 (0x1469736c9d85 in /lib64/libc.so.6)
frame #45: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x584cfe]
. This may indicate a possible application crash on rank 0 or a network set up issue.
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
Exception raised from doWait at ../torch/csrc/distributed/c10d/TCPStore.cpp:550 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x1535a02d8d87 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x15c0e57 (0x1535d7cfae57 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x1535dbfc9ce2 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x1535dbfcab11 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1535dbf7ff81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1535dbf7ff81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1535dbf7ff81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1535dbf7ff81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x1535a14544e9 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x1535a145b4db in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::allgather(std::vector<std::vector<at::Tensor, std::allocator<at::Tensor> >, std::allocator<std::vector<at::Tensor, std::allocator<at::Tensor> > > >&, std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllgatherOptions const&) + 0xb5c (0x1535a14718dc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x583a31d (0x1535dbf7431d in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5844218 (0x1535dbf7e218 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x4e893cc (0x1535db5c33cc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x1a08a88 (0x1535d8142a88 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x584ba33 (0x1535dbf85a33 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5856e1f (0x1535dbf90e1f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: c10d::verify_params_across_processes(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::optional<std::weak_ptr<c10d::Logger> > const&) + 0x26f (0x1535dbff748f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xc57771 (0x1535ee7fa771 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x413f14 (0x1535edfb6f14 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fc697]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f614b in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x53d6 (0x4f2376 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #26: _PyObject_FastCallDictTstate + 0x17d (0x4f56cd in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #27: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x505be8]
frame #28: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4f64b6]
frame #29: PyObject_Call + 0x209 (0x5089a9 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x2b79 (0x4efb19 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #33: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x591d92]
frame #34: PyEval_EvalCode + 0x87 (0x591cd7 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #35: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5991cd]
frame #36: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fccc4]
frame #37: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #41: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5b4dcf]
frame #42: Py_RunMain + 0xc2 (0x5b48b2 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #43: Py_BytesMain + 0x39 (0x584e49 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #44: __libc_start_main + 0xe5 (0x153600863d85 in /lib64/libc.so.6)
frame #45: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x584cfe]
. This may indicate a possible application crash on rank 0 or a network set up issue.
[rank2]:[2024-03-27 21:50:11,566] torch._dynamo.utils: [INFO] TorchDynamo compilation metrics:
[rank2]:[2024-03-27 21:50:11,566] torch._dynamo.utils: [INFO] Function, Runtimes (s)
[rank1]:[2024-03-27 21:50:11,566] torch._dynamo.utils: [INFO] TorchDynamo compilation metrics:
[rank1]:[2024-03-27 21:50:11,566] torch._dynamo.utils: [INFO] Function, Runtimes (s)
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: [3] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
Exception raised from doWait at ../torch/csrc/distributed/c10d/TCPStore.cpp:550 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14a111785d87 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x15c0e57 (0x14a1491a7e57 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14a14d476ce2 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14a14d477b11 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a14d42cf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a14d42cf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a14d42cf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14a14d42cf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14a1129014e9 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x14a1129084db in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::allgather(std::vector<std::vector<at::Tensor, std::allocator<at::Tensor> >, std::allocator<std::vector<at::Tensor, std::allocator<at::Tensor> > > >&, std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllgatherOptions const&) + 0xb5c (0x14a11291e8dc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x583a31d (0x14a14d42131d in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5844218 (0x14a14d42b218 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x4e893cc (0x14a14ca703cc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x1a08a88 (0x14a1495efa88 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x584ba33 (0x14a14d432a33 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5856e1f (0x14a14d43de1f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: c10d::verify_params_across_processes(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::optional<std::weak_ptr<c10d::Logger> > const&) + 0x26f (0x14a14d4a448f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xc57771 (0x14a15fca7771 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x413f14 (0x14a15f463f14 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fc697]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f614b in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x53d6 (0x4f2376 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #26: _PyObject_FastCallDictTstate + 0x17d (0x4f56cd in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #27: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x505be8]
frame #28: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4f64b6]
frame #29: PyObject_Call + 0x209 (0x5089a9 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x2b79 (0x4efb19 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #33: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x591d92]
frame #34: PyEval_EvalCode + 0x87 (0x591cd7 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #35: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5991cd]
frame #36: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fccc4]
frame #37: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #41: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5b4dcf]
frame #42: Py_RunMain + 0xc2 (0x5b48b2 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #43: Py_BytesMain + 0x39 (0x584e49 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #44: __libc_start_main + 0xe5 (0x14a171d10d85 in /lib64/libc.so.6)
frame #45: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x584cfe]
. This may indicate a possible application crash on rank 0 or a network set up issue.
[rank3]:[2024-03-27 21:50:11,567] torch._dynamo.utils: [INFO] TorchDynamo compilation metrics:
[rank3]:[2024-03-27 21:50:11,567] torch._dynamo.utils: [INFO] Function, Runtimes (s)
[2024-03-27 21:50:21,489] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 1 (pid: 3603) of binary: /gscratch/krishna/arnabk1/pyclip/bin/python
Traceback (most recent call last):
  File "/gscratch/krishna/arnabk1/pyclip/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
training.main FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-03-27_21:50:21
  host      : g3077.hyak.local
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3604)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-03-27_21:50:21
  host      : g3077.hyak.local
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3605)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-03-27_21:50:21
  host      : g3077.hyak.local
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3603)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
