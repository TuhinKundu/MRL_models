[2024-03-27 18:53:19,414] torch.distributed.run: [WARNING] 
[2024-03-27 18:53:19,414] torch.distributed.run: [WARNING] *****************************************
[2024-03-27 18:53:19,414] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-03-27 18:53:19,414] torch.distributed.run: [WARNING] *****************************************
2024-03-27,18:54:36 | INFO | Running in distributed mode with multiple processes. Device: cuda:3.Process (global: 3, local 3), total 4.
2024-03-27,18:54:36 | INFO | Loaded ViT-B-16 model config.
2024-03-27,18:54:36 | INFO | Running in distributed mode with multiple processes. Device: cuda:2.Process (global: 2, local 2), total 4.
2024-03-27,18:54:36 | INFO | Loaded ViT-B-16 model config.
2024-03-27,18:54:36 | INFO | Running in distributed mode with multiple processes. Device: cuda:1.Process (global: 1, local 1), total 4.
2024-03-27,18:54:36 | INFO | Loaded ViT-B-16 model config.
2024-03-27,18:54:40 | INFO | Loading pretrained ViT-B-16 weights (laion400m_e32).
2024-03-27,18:54:40 | INFO | Loading pretrained ViT-B-16 weights (laion400m_e32).
2024-03-27,18:54:40 | INFO | Loading pretrained ViT-B-16 weights (laion400m_e32).
[rank1]:[W socket.cpp:432] [c10d] While waitForInput, poolFD failed with (errno: 0 - Success).
[rank3]:[W socket.cpp:432] [c10d] While waitForInput, poolFD failed with (errno: 0 - Success).
[rank2]:[W socket.cpp:432] [c10d] While waitForInput, poolFD failed with (errno: 0 - Success).
Traceback (most recent call last):
Traceback (most recent call last):
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 196, in _run_module_as_main
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 196, in _run_module_as_main
Traceback (most recent call last):
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 472, in <module>
    return _run_code(code, main_globals, None,
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 472, in <module>
    return _run_code(code, main_globals, None,
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 472, in <module>
    main(sys.argv[1:])
      File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 282, in main
main(sys.argv[1:])
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 282, in main
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[device], **ddp_args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[device], **ddp_args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    main(sys.argv[1:])
  File "/mmfs1/gscratch/krishna/arnabk1/mayank_clip_mrl/src/training/main.py", line 282, in main
    model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[device], **ddp_args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: [2] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
Exception raised from doWait at ../torch/csrc/distributed/c10d/TCPStore.cpp:550 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x153a66983d87 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x15c0e57 (0x153a9e3a5e57 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x153aa2674ce2 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x153aa2675b11 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153aa262af81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153aa262af81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153aa262af81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153aa262af81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x153a67aff4e9 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x153a67b064db in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::allgather(std::vector<std::vector<at::Tensor, std::allocator<at::Tensor> >, std::allocator<std::vector<at::Tensor, std::allocator<at::Tensor> > > >&, std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllgatherOptions const&) + 0xb5c (0x153a67b1c8dc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x583a31d (0x153aa261f31d in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5844218 (0x153aa2629218 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x4e893cc (0x153aa1c6e3cc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x1a08a88 (0x153a9e7eda88 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x584ba33 (0x153aa2630a33 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5856e1f (0x153aa263be1f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: c10d::verify_params_across_processes(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::optional<std::weak_ptr<c10d::Logger> > const&) + 0x26f (0x153aa26a248f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xc57771 (0x153ab4ea5771 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x413f14 (0x153ab4661f14 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fc697]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f614b in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x53d6 (0x4f2376 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #26: _PyObject_FastCallDictTstate + 0x17d (0x4f56cd in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #27: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x505be8]
frame #28: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4f64b6]
frame #29: PyObject_Call + 0x209 (0x5089a9 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x2b79 (0x4efb19 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #33: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x591d92]
frame #34: PyEval_EvalCode + 0x87 (0x591cd7 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #35: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5991cd]
frame #36: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fccc4]
frame #37: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #41: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5b4dcf]
frame #42: Py_RunMain + 0xc2 (0x5b48b2 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #43: Py_BytesMain + 0x39 (0x584e49 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #44: __libc_start_main + 0xe5 (0x153ac6f0ed85 in /lib64/libc.so.6)
frame #45: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x584cfe]
. This may indicate a possible application crash on rank 0 or a network set up issue.
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: [3] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
Exception raised from doWait at ../torch/csrc/distributed/c10d/TCPStore.cpp:550 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x1474beb76d87 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x15c0e57 (0x1474f6598e57 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x1474fa867ce2 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x1474fa868b11 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1474fa81df81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1474fa81df81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1474fa81df81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1474fa81df81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x1474bfcf24e9 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x1474bfcf94db in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::allgather(std::vector<std::vector<at::Tensor, std::allocator<at::Tensor> >, std::allocator<std::vector<at::Tensor, std::allocator<at::Tensor> > > >&, std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllgatherOptions const&) + 0xb5c (0x1474bfd0f8dc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x583a31d (0x1474fa81231d in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5844218 (0x1474fa81c218 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x4e893cc (0x1474f9e613cc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x1a08a88 (0x1474f69e0a88 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x584ba33 (0x1474fa823a33 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5856e1f (0x1474fa82ee1f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: c10d::verify_params_across_processes(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::optional<std::weak_ptr<c10d::Logger> > const&) + 0x26f (0x1474fa89548f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xc57771 (0x14750d098771 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x413f14 (0x14750c854f14 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fc697]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f614b in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x53d6 (0x4f2376 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #26: _PyObject_FastCallDictTstate + 0x17d (0x4f56cd in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #27: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x505be8]
frame #28: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4f64b6]
frame #29: PyObject_Call + 0x209 (0x5089a9 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x2b79 (0x4efb19 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #33: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x591d92]
frame #34: PyEval_EvalCode + 0x87 (0x591cd7 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #35: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5991cd]
frame #36: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fccc4]
frame #37: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #41: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5b4dcf]
frame #42: Py_RunMain + 0xc2 (0x5b48b2 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #43: Py_BytesMain + 0x39 (0x584e49 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #44: __libc_start_main + 0xe5 (0x14751f101d85 in /lib64/libc.so.6)
frame #45: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x584cfe]
. This may indicate a possible application crash on rank 0 or a network set up issue.
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Socket Timeout
Exception raised from doWait at ../torch/csrc/distributed/c10d/TCPStore.cpp:550 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x14db6d944d87 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x15c0e57 (0x14dba5366e57 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x14dba9635ce2 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::get(std::string const&) + 0xa1 (0x14dba9636b11 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dba95ebf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dba95ebf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dba95ebf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14dba95ebf81 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x14db6eac04e9 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x14db6eac74db in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #10: c10d::ProcessGroupNCCL::allgather(std::vector<std::vector<at::Tensor, std::allocator<at::Tensor> >, std::allocator<std::vector<at::Tensor, std::allocator<at::Tensor> > > >&, std::vector<at::Tensor, std::allocator<at::Tensor> >&, c10d::AllgatherOptions const&) + 0xb5c (0x14db6eadd8dc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: <unknown function> + 0x583a31d (0x14dba95e031d in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #12: <unknown function> + 0x5844218 (0x14dba95ea218 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #13: <unknown function> + 0x4e893cc (0x14dba8c2f3cc in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x1a08a88 (0x14dba57aea88 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x584ba33 (0x14dba95f1a33 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x5856e1f (0x14dba95fce1f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: c10d::verify_params_across_processes(c10::intrusive_ptr<c10d::ProcessGroup, c10::detail::intrusive_target_default_null_type<c10d::ProcessGroup> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::optional<std::weak_ptr<c10d::Logger> > const&) + 0x26f (0x14dba966348f in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0xc57771 (0x14dbbbe66771 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #19: <unknown function> + 0x413f14 (0x14dbbb622f14 in /gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #20: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fc697]
frame #21: _PyObject_MakeTpCall + 0x25b (0x4f614b in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #22: _PyEval_EvalFrameDefault + 0x53d6 (0x4f2376 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #23: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #25: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #26: _PyObject_FastCallDictTstate + 0x17d (0x4f56cd in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #27: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x505be8]
frame #28: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4f64b6]
frame #29: PyObject_Call + 0x209 (0x5089a9 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #30: _PyEval_EvalFrameDefault + 0x2b79 (0x4efb19 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #31: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #32: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #33: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x591d92]
frame #34: PyEval_EvalCode + 0x87 (0x591cd7 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #35: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5991cd]
frame #36: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x4fccc4]
frame #37: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #38: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x31f (0x4ed2bf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #40: _PyFunction_Vectorcall + 0x6f (0x4fcadf in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #41: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x5b4dcf]
frame #42: Py_RunMain + 0xc2 (0x5b48b2 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #43: Py_BytesMain + 0x39 (0x584e49 in /gscratch/krishna/arnabk1/pyclip/bin/python)
frame #44: __libc_start_main + 0xe5 (0x14dbcdecfd85 in /lib64/libc.so.6)
frame #45: /gscratch/krishna/arnabk1/pyclip/bin/python() [0x584cfe]
. This may indicate a possible application crash on rank 0 or a network set up issue.
[rank2]:[2024-03-27 21:54:42,981] torch._dynamo.utils: [INFO] TorchDynamo compilation metrics:
[rank2]:[2024-03-27 21:54:42,981] torch._dynamo.utils: [INFO] Function, Runtimes (s)
[rank3]:[2024-03-27 21:54:42,981] torch._dynamo.utils: [INFO] TorchDynamo compilation metrics:
[rank3]:[2024-03-27 21:54:42,981] torch._dynamo.utils: [INFO] Function, Runtimes (s)
[rank1]:[2024-03-27 21:54:42,982] torch._dynamo.utils: [INFO] TorchDynamo compilation metrics:
[rank1]:[2024-03-27 21:54:42,982] torch._dynamo.utils: [INFO] Function, Runtimes (s)
[2024-03-27 21:54:49,745] torch.distributed.elastic.multiprocessing.api: [WARNING] Sending process 38869 closing signal SIGTERM
[2024-03-27 21:54:49,959] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 2 (pid: 38870) of binary: /gscratch/krishna/arnabk1/pyclip/bin/python
Traceback (most recent call last):
  File "/gscratch/krishna/arnabk1/pyclip/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/gscratch/krishna/arnabk1/pyclip/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
training.main FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-03-27_21:54:49
  host      : g3065.hyak.local
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 38871)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-03-27_21:54:49
  host      : g3065.hyak.local
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 38870)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
